# AiCarpool å•å…ƒæµ‹è¯•è®¡åˆ’æ€»è§ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

AiCarpool æ˜¯ä¸€ä¸ªä¼ä¸šçº§ AI èµ„æºç®¡ç†å¹³å°ï¼Œæä¾›æ™ºèƒ½è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€æƒé™ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚æœ¬æµ‹è¯•è®¡åˆ’æ—¨åœ¨å»ºç«‹å®Œæ•´çš„å•å…ƒæµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚

## ğŸ¯ æµ‹è¯•ç›®æ ‡

1. **è¦†ç›–ç‡ç›®æ ‡**
   - æ€»ä½“ä»£ç è¦†ç›–ç‡ï¼š80%ä»¥ä¸Š
   - æ ¸å¿ƒæ¨¡å—è¦†ç›–ç‡ï¼š95%ä»¥ä¸Š
   - å…³é”®è·¯å¾„è¦†ç›–ç‡ï¼š100%

2. **è´¨é‡ç›®æ ‡**
   - é›¶å…³é”®ç¼ºé™·
   - æ‰€æœ‰æµ‹è¯•æ‰§è¡Œæ—¶é—´ < 60ç§’
   - æµ‹è¯•å¯ç»´æŠ¤æ€§é«˜

3. **ä¸šåŠ¡ç›®æ ‡**
   - ä¿éšœæ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ­£ç¡®æ€§
   - å‡å°‘ç”Ÿäº§ç¯å¢ƒæ•…éšœç‡
   - æé«˜å¼€å‘æ•ˆç‡

## ğŸ— æµ‹è¯•æ¶æ„

### æµ‹è¯•æŠ€æœ¯æ ˆ
- **æµ‹è¯•æ¡†æ¶**: Jest 30.x
- **Reactæµ‹è¯•**: @testing-library/react
- **APIæµ‹è¯•**: Supertest
- **Mockå·¥å…·**: jest-mock-extended, MSW
- **è¦†ç›–ç‡å·¥å…·**: Jest Coverage

### æµ‹è¯•åˆ†å±‚
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         E2E Tests (10%)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Integration Tests (30%)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Unit Tests (60%)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š æ¨¡å—ä¼˜å…ˆçº§çŸ©é˜µ

| æ¨¡å—åˆ†ç±» | ä¼˜å…ˆçº§ | è¦†ç›–ç‡è¦æ±‚ | æµ‹è¯•é‡ç‚¹ |
|---------|--------|-----------|---------|
| è®¤è¯ä¸å®‰å…¨ | ğŸ”´ é«˜ | 95% | JWTã€æƒé™éªŒè¯ã€APIå¯†é’¥ |
| æ ¸å¿ƒæœåŠ¡ | ğŸ”´ é«˜ | 95% | AIè·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€é™æµ |
| æ•°æ®å¤„ç† | ğŸŸ¡ ä¸­ | 85% | éªŒè¯ã€ç¼“å­˜ã€é˜Ÿåˆ— |
| Reactç»„ä»¶ | ğŸŸ¡ ä¸­ | 80% | å…³é”®UIç»„ä»¶ã€è¡¨å• |
| è‡ªå®šä¹‰Hooks | ğŸŸ¡ ä¸­ | 85% | ä¸šåŠ¡é€»è¾‘Hooks |
| APIè·¯ç”± | ğŸŸ¢ ä½ | 75% | ç«¯ç‚¹éªŒè¯ã€é”™è¯¯å¤„ç† |

## ğŸ“… å®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è®¾æ–½ï¼ˆå·²å®Œæˆï¼‰
- âœ… æµ‹è¯•ç¯å¢ƒæ­å»º
- âœ… Jesté…ç½®
- âœ… æµ‹è¯•å·¥å…·å‡½æ•°
- âœ… Mockç­–ç•¥åˆ¶å®š

### ç¬¬äºŒé˜¶æ®µï¼šè®¤è¯ä¸å®‰å…¨ï¼ˆç¬¬1å‘¨ï¼‰
- [ ] JWTå·¥å…·æµ‹è¯•
- [ ] è®¤è¯ä¸­é—´ä»¶æµ‹è¯•
- [ ] æƒé™ç®¡ç†æµ‹è¯•
- [ ] APIå¯†é’¥éªŒè¯æµ‹è¯•

### ç¬¬ä¸‰é˜¶æ®µï¼šæ ¸å¿ƒæœåŠ¡ï¼ˆç¬¬2å‘¨ï¼‰
- [ ] SmartAiRouteræµ‹è¯•
- [ ] LoadBalanceræµ‹è¯•
- [ ] RateLimiteræµ‹è¯•
- [ ] AccountPoolManageræµ‹è¯•

### ç¬¬å››é˜¶æ®µï¼šæ•°æ®å¤„ç†ï¼ˆç¬¬3å‘¨ï¼‰
- [ ] è¾“å…¥éªŒè¯å™¨æµ‹è¯•
- [ ] ç¼“å­˜æœåŠ¡æµ‹è¯•
- [ ] é˜Ÿåˆ—å¤„ç†å™¨æµ‹è¯•
- [ ] æ•°æ®è½¬æ¢å·¥å…·æµ‹è¯•

### ç¬¬äº”é˜¶æ®µï¼šUIç»„ä»¶ï¼ˆç¬¬4å‘¨ï¼‰
- [ ] è®¤è¯ç»„ä»¶æµ‹è¯•
- [ ] ä»ªè¡¨æ¿ç»„ä»¶æµ‹è¯•
- [ ] è¡¨å•ç»„ä»¶æµ‹è¯•
- [ ] æƒé™å®ˆå«æµ‹è¯•

### ç¬¬å…­é˜¶æ®µï¼šé›†æˆæµ‹è¯•ï¼ˆç¬¬5å‘¨ï¼‰
- [ ] Hooksæµ‹è¯•
- [ ] APIè·¯ç”±æµ‹è¯•
- [ ] ç«¯åˆ°ç«¯æµç¨‹æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•

## ğŸ“ æµ‹è¯•æ–‡ä»¶ç»„ç»‡

```
src/
â”œâ”€â”€ __tests__/
â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/           # è®¤è¯ç›¸å…³æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ services/       # æœåŠ¡å±‚æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ rate-limit/     # é™æµæµ‹è¯•
â”‚   â”‚   â”‚   â””â”€â”€ utils/          # å·¥å…·å‡½æ•°æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/           # è®¤è¯ç»„ä»¶æµ‹è¯•
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/      # ä»ªè¡¨æ¿ç»„ä»¶æµ‹è¯•
â”‚   â”‚   â”‚   â””â”€â”€ enterprise/     # ä¼ä¸šç»„ä»¶æµ‹è¯•
â”‚   â”‚   â””â”€â”€ hooks/              # è‡ªå®šä¹‰Hooksæµ‹è¯•
â”‚   â”œâ”€â”€ integration/            # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ e2e/                   # ç«¯åˆ°ç«¯æµ‹è¯•
```

## ğŸ” æµ‹è¯•æ ‡å‡†

### å‘½åè§„èŒƒ
```typescript
describe('ModuleName', () => {
  describe('functionName', () => {
    it('should perform expected behavior when condition is met', () => {
      // Test implementation
    });
  });
});
```

### æµ‹è¯•ç»“æ„ï¼ˆAAAæ¨¡å¼ï¼‰
```typescript
it('should validate user credentials', () => {
  // Arrange
  const credentials = { email: 'test@example.com', password: 'Test123!' };
  
  // Act
  const result = validateCredentials(credentials);
  
  // Assert
  expect(result.isValid).toBe(true);
});
```

### MockåŸåˆ™
1. æœ€å°åŒ–Mock - åªMockå¿…è¦çš„ä¾èµ–
2. çœŸå®æ€§ - Mockè¡Œä¸ºåº”æ¥è¿‘çœŸå®å®ç°
3. éš”ç¦»æ€§ - æ¯ä¸ªæµ‹è¯•ç‹¬ç«‹ï¼Œä¸ç›¸äº’å½±å“
4. å¯ç»´æŠ¤æ€§ - Mockæ˜“äºç†è§£å’Œä¿®æ”¹

## ğŸ“ˆ è¦†ç›–ç‡æ ‡å‡†

### è¦†ç›–ç‡æŒ‡æ ‡
- **è¯­å¥è¦†ç›–ç‡(Statements)**: 80%
- **åˆ†æ”¯è¦†ç›–ç‡(Branches)**: 75%
- **å‡½æ•°è¦†ç›–ç‡(Functions)**: 85%
- **è¡Œè¦†ç›–ç‡(Lines)**: 80%

### æ ¸å¿ƒæ¨¡å—ç‰¹æ®Šè¦æ±‚
```javascript
// jest.config.js
coverageThreshold: {
  './src/lib/auth/**': {
    branches: 95,
    functions: 95,
    lines: 95,
    statements: 95
  },
  './src/lib/services/smart-ai-router.ts': {
    branches: 90,
    functions: 95,
    lines: 90,
    statements: 90
  }
}
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
npm test -- auth

# è¿è¡Œè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# ç›‘å¬æ¨¡å¼
npm run test:watch
```

### æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
```bash
# HTMLæŠ¥å‘Š
open coverage/lcov-report/index.html

# ç»ˆç«¯æŠ¥å‘Š
npm run test:coverage -- --coverageReporters=text
```

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### æµ‹è¯•ç¼–å†™æ£€æŸ¥
- [ ] æµ‹è¯•åç§°æ¸…æ™°æè¿°è¡Œä¸º
- [ ] éµå¾ªAAAæ¨¡å¼
- [ ] åŒ…å«æ­£å¸¸å’Œå¼‚å¸¸åœºæ™¯
- [ ] æµ‹è¯•ç‹¬ç«‹å¯é‡å¤
- [ ] Mockæœ€å°åŒ–ä¸”åˆç†

### ä»£ç è´¨é‡æ£€æŸ¥
- [ ] æ— ç¡¬ç¼–ç æµ‹è¯•æ•°æ®
- [ ] ä½¿ç”¨æµ‹è¯•å·¥å‚å‡½æ•°
- [ ] æ¸…ç†å‰¯ä½œç”¨
- [ ] å¼‚æ­¥æµ‹è¯•æ­£ç¡®å¤„ç†
- [ ] é”™è¯¯ä¿¡æ¯æœ‰æ„ä¹‰

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [æµ‹è¯•ç¯å¢ƒæ­å»º](../01-testing-setup.md)
- [å•å…ƒæµ‹è¯•æŒ‡å—](../02-unit-testing.md)
- [é›†æˆæµ‹è¯•æŒ‡å—](../03-integration-testing.md)
- [æµ‹è¯•é—®é¢˜æ’æŸ¥](../troubleshooting.md)

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. æŸ¥çœ‹å„æ¨¡å—è¯¦ç»†æµ‹è¯•è®¡åˆ’
2. ä»é«˜ä¼˜å…ˆçº§æ¨¡å—å¼€å§‹å®æ–½
3. å®šæœŸæ›´æ–°è¿›åº¦è·Ÿè¸ªæ–‡æ¡£
4. æŒç»­ä¼˜åŒ–æµ‹è¯•ç­–ç•¥

---

*æœ€åæ›´æ–°: 2025-01-12*
*è´Ÿè´£äºº: AIæµ‹è¯•å›¢é˜Ÿ*